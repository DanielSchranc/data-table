{"version":3,"sources":["root.module.js","common/app.module.js","components/components.module.js","components/callcenter/callcenter.module.js","root.component.js","common/storage.service.js","components/callcenter/callcenter-api.service.js","components/callcenter/callcenter.service.js","components/callcenter/table/table.component.js","components/callcenter/table/table.controller.js","components/callcenter/table-row/table-row-total.filter.js","components/callcenter/table-row/table-row.component.js","components/callcenter/table-row/table-row.controller.js","components/callcenter/table-search/table-search.component.js","components/callcenter/table-search/table-search.controller.js","components/callcenter/table-search/table-search.filter.js","templates.js"],"names":[],"mappings":"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","file":"bundle.js","sourcesContent":["angular\n  .module('root', [\n    'common',\n    'components',\n    'templates'\n  ]);","angular\n  .module('common', []);","angular\n  .module('components', [\n    'components.callcenter'\n  ]);","angular\n  .module('components.callcenter', [\n    'ngStorage'\n  ])\n  .constant('CONFIG', {\n    API: {\n      CALLS: 'https://data.gov.sk/api/3/action/datastore_search'\n    },\n    PRELOAD_RESOURCE: {\n      \"resource_group_id\": \"069a1c5e-7243-4e69-844d-f7cfc41e277e\",\n      \"data_correctness\": \"correct and exact\",\n      \"maintainer\": \"2DF13D50-0B6F-48BA-884E-BE66DC0A2934\",\n      \"periodicity\": \"annually\",\n      \"cache_last_updated\": null,\n      \"webstore_last_updated\": null,\n      \"datastore_active\": true,\n      \"id\": \"c2098147-16f3-41fc-acee-638a31bf3bbf\",\n      \"size\": null,\n      \"valid_from\": \"\",\n      \"validity_description\": \"\",\n      \"state\": \"active\",\n      \"transformed\": false,\n      \"last_modified\": null,\n      \"on_same_domain\": true,\n      \"schema\": \"\",\n      \"status\": \"public\",\n      \"periodicity_description\": \"\",\n      \"hash\": \"\",\n      \"description\": \"\",\n      \"format\": \"CSV\",\n      \"validity\": \"perm_valid\",\n      \"tracking_summary\": { \"total\": 1, \"recent\": 1 },\n      \"mimetype_inner\": null,\n      \"url_type\": \"upload\",\n      \"active_to\": \"\",\n      \"data_correctness_description\": \"\",\n      \"active_from\": \"\",\n      \"mimetype\": null,\n      \"cache_url\": null,\n      \"name\": \"Pocty volan\\u00ed 112 za rok 2016\",\n      \"created\": \"2017-03-31T13:07:48.717885\",\n      \"url\": \"https://data.gov.sk/dataset/ec254f6d-ba3b-4abc-9ae5-6e6bc3b68e00/resource/c2098147-16f3-41fc-acee-638a31bf3bbf/download/poctyvolaniltv112zarok2016.csv\",\n      \"valid_to\": \"\",\n      \"webstore_url\": null,\n      \"position\": 0,\n      \"revision_id\": \"06cb0d82-bc67-4b01-b74b-fc36ee053d12\",\n      \"resource_type\": null\n    }\n  });\n","var root = {\n  templateUrl: './root.html'\n};\n\nangular\n  .module('root')\n  .component('root', root);","function StorageService($localStorage) {\n  $localStorage = $localStorage.$default({\n    items: []\n  });\n\n  function add(item) {\n    $localStorage.items = item;\n  }\n\n  function getAll() {\n    return $localStorage.items;\n  };\n\n  function remove(item) {\n    $localStorage.items.splice($localStorage.items.indexOf(item), 1);\n  }\n\n  function removeAll() {\n    $localStorage.$reset();\n  }\n\n  // Public API\n  return {\n    add: add,\n    getAll: getAll,\n    remove: remove,\n    removeAll: removeAll\n  };\n}\nangular\n  .module('common')\n  .factory('StorageService', StorageService);\n","function CallcenterAPIService($http, StorageService, CONFIG) {\n  var api = CONFIG.API.CALLS;\n  var data = CONFIG.PRELOAD_RESOURCE;\n  var records = [];\n\n  this.getEmergencyCalls = function() {\n    return $http\n      .post(api, data)\n      .then(function(response) {\n        records = response.data.result.records;\n        return records;\n      }, function(reason) {\n        console.error('Error: CallcenterAPIService: ', reason);\n      });\n  }\n\n}\n\nangular\n  .module('components.callcenter')\n  .service('CallcenterAPIService', CallcenterAPIService);\n","function CallcenterService(CallcenterAPIService) {\n\n  var identifiers = [\n    { id: 'Banská Bystrica' },\n    { id: 'Bratislava' },\n    { id: 'Koice' },\n    { id: 'Nitra' },\n    { id: 'Preov' },\n    { id: 'Trenčín' },\n    { id: 'Trnava' },\n    { id: \"ilina\" }\n  ];\n\n  function getFilteredArray(array, idArray) {\n    var newArray = [];\n    idArray.forEach(function(item) {\n      var filtered = [];\n      filtered = array.filter(function(value) {\n        return value.Callcentername === item.id;\n      });\n      newArray.push(filtered);\n    });\n    return newArray;\n  }\n\n  var getTransformedData = function() {\n      return CallcenterAPIService\n        .getEmergencyCalls()\n        .then(function(response) {\n          // Returns new array of arrays for each city\n          return getFilteredArray(response, identifiers);\n        });\n    }\n\n  return {\n    getData: getTransformedData\n  }\n}\n\nangular\n  .module('components.callcenter')\n  .factory('CallcenterService', CallcenterService);\n","var callcenterTable = {\n  templateUrl: './table.html',\n  controller: 'CallcenterTableController'\n};\n\nangular\n  .module('components.callcenter')\n  .component('callcenterTable', callcenterTable);","function CallcenterTableController(StorageService, CallcenterService, $filter) {\n  var ctrl = this;\n  ctrl.CallsData = [];\n\n  ctrl.$onInit = function() {\n    ctrl.tableSearchFilter = $filter('tableSearchFilter');\n  }\n\n  function storeCallcenterData(response) {\n    ctrl.CallsData = response;\n    ctrl.filteredCities = ctrl.CallsData;\n    console.log(ctrl.filteredCities);\n    if (!StorageService.getAll().length) {\n      StorageService.add(ctrl.CallsData);\n    }\n  }\n\n  function getCallcenterData() {\n    CallcenterService\n      .getData()\n      .then(storeCallcenterData);\n  }\n\n  function getCallcenterDataFromStorage() {\n    if (navigator.onLine) {\n      getCallcenterData();\n    } else {\n      ctrl.CallsData = StorageService.getAll();\n    }\n  }\n\n  getCallcenterDataFromStorage();\n\n  ctrl.updateResults = function(event) {\n    ctrl.filteredCities = ctrl.tableSearchFilter(ctrl.CallsData, event.city);\n  }\n\n};\n\nangular\n  .module('components.callcenter')\n  .controller('CallcenterTableController', CallcenterTableController);\n","function totalCallsFilter() {\n  return function(collection, param) {\n    var total = 0;\n    collection.forEach(function(item) {\n      total += parseInt(item[param]);\n    });\n    return total;\n  }\n}\n\nangular\n  .module('components.callcenter')\n  .filter('totalCallsFilter', totalCallsFilter);","var callcenterTableRow = {\n  bindings: {\n    cities: '<'\n  },\n  templateUrl: './table-row.html',\n  controller: 'CallcenterTableRowController'\n};\n\nangular\n  .module('components.callcenter')\n  .component('callcenterTableRow', callcenterTableRow);","function CallcenterTableRowController($filter) {\n  var ctrl = this;\n\n  ctrl.$onInit = function() {\n    ctrl.cities = ctrl.cities;\n    ctrl.totalCallsFilter = $filter('totalCallsFilter');\n  }\n\n  ctrl.getTotal = function(key) {\n    return ctrl.totalCallsFilter(ctrl.cities, key);\n  }\n\n  ctrl.deleteItem = function(index) {\n    ctrl.cities.splice(index, 1);\n  }\n}\n\nangular\n  .module('components.callcenter')\n  .controller('CallcenterTableRowController', CallcenterTableRowController);\n","var callcenterTableSearch = {\n  bindings: {\n    onUpdateResults: '&'\n  },\n  templateUrl: './table-search.html',\n  controller: 'CallcenterTableSearchController'\n};\n\nangular\n  .module('components.callcenter')\n  .component('callcenterTableSearch', callcenterTableSearch);","function CallcenterTableSearchController($filter) {\n  var ctrl = this;\n\n  ctrl.$onInit = function() {\n    ctrl.city = '';\n  }\n\n  ctrl.updateCityResults = function(event) {\n    ctrl.onUpdateResults({\n      $event: {\n        city: event\n      }\n    });\n  }\n\n  // ctrl.$onChanges = function(changes) {\n  //   console.log(changes);\n  // }\n\n  // ctrl.updateResults = function(city) {\n  //   ctrl.tableSearchFilter(city);\n  //   console.log(model);\n  // }\n};\n\nangular\n  .module('components.callcenter')\n  .controller('CallcenterTableSearchController', CallcenterTableSearchController);\n","function tableSearchFilter() {\n  return function(collection, param) {\n    if (!param) return collection;\n\n    var newArray = [];\n    collection.forEach(function(array) {\n      var filter = [];\n      filter = array.filter(function(item) {\n        return item.Callcentername.toLowerCase().indexOf(param.toLowerCase()) !== -1;\n      });\n      newArray.push(filter);\n    });\n    return newArray;\n  }\n}\nangular\n  .module('components.callcenter')\n  .filter('tableSearchFilter', tableSearchFilter);\n","angular.module('templates', []).run(['$templateCache', function($templateCache) {$templateCache.put('./root.html','<div class=\"root\"><header><h1>Emergency calls statistics per year 2016</h1></header><callcenter-table></callcenter-table></div>');\n$templateCache.put('./table.html','<div class=\"calls-table\"><callcenter-table-search on-update-results=\"$ctrl.updateResults($event)\"></callcenter-table-search><ul class=\"calls-table__list\"><li ng-repeat=\"cities in $ctrl.filteredCities track by $index\"><callcenter-table-row cities=\"cities\"></callcenter-table-row></li></ul></div>');\n$templateCache.put('./table-row.html','<ul class=\"calls-table__list--data\"><li style=\"margin-right: 16px; width: auto\"></li><li>City:</li><li>Month:</li><li>Identified:</li><li>Not Identified:</li><li>All:</li><li>Answered:</li><li>Justified:</li></ul><ul ng-repeat=\"item in $ctrl.cities\" class=\"calls-table__list--data\"><li class=\"calls-table__delete\" ng-click=\"$ctrl.deleteItem($index);\">x</li><li><span>{{item.Callcentername}}</span></li><li><span>{{item.mesiac}}</span></li><li><span>{{item.Identifikovane}}</span></li><li><span>{{item.Neidentifikovane}}</span></li><li><span>{{item.Vsetky}}</span></li><li><span>{{item.Zdvihnute}}</span></li><li><span>{{item.Opravnene}}</span></li><ul><li></li></ul></ul><ul class=\"calls-table__list--total\"><li style=\"margin-right: 16px; width: auto\"></li><li>Total per year:</li><li>&nbsp;</li><li>{{$ctrl.getTotal(\\'Identifikovane\\')}}</li><li>{{$ctrl.getTotal(\\'Neidentifikovane\\')}}</li><li>{{$ctrl.getTotal(\\'Vsetky\\')}}</li><li>{{$ctrl.getTotal(\\'Zdvihnute\\')}}</li><li>{{$ctrl.getTotal(\\'Opravnene\\')}}</li></ul>');\n$templateCache.put('./table-search.html','<div class=\"calls-table__search\"><label>Type and search <input type=\"text\" placeholder=\"Search city\" ng-model=\"$ctrl.city\" ng-model-options=\"{\\n              \\'updateOn\\': \\'default blur\\',\\n              \\'debounce\\': {\\n                \\'default\\': 250,\\n                \\'blur\\': 0\\n              }\\n            }\" ng-change=\"$ctrl.updateCityResults($ctrl.city)\"></label></div>');}]);"]}